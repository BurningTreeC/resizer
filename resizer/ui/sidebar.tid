title: $:/core/ui/PageTemplate/sidebar
tags: $:/tags/PageTemplate
code-body: yes

\whitespace trim
\define config-title()
$:/config/SideBarSegments/Visibility/$(listItem)$
\end

\procedure on-resize-start-action-fluid-fixed() <$action-setfield $tiddler="$:/themes/tiddlywiki/vanilla/metrics/sidebarwidth" throttle.refresh="yes"/>

\procedure on-resize-start-action-fixed-fluid()
<$list filter="storyright storywidth tiddlerwidth" variable="suffix">
<$action-setfield $tiddler={{{ [[$:/themes/tiddlywiki/vanilla/metrics/]addsuffix<suffix>] }}} throttle.refresh="yes"/>
</$list>
\end

\procedure fluid-fixed-dblclick-actions()
<$action-deletetiddler $tiddler="$:/themes/tiddlywiki/vanilla/metrics/sidebarwidth"/>
\end

\procedure fixed-fluid-dblclick-actions()
<$action-deletetiddler $filter="$:/themes/tiddlywiki/vanilla/metrics/storyright $:/themes/tiddlywiki/vanilla/metrics/storywidth $:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth"/>
\end

<div class="tc-sidebar-scrollable-wrapper">

<%if [{$:/state/sidebar}!match[no]] %>
<%if [{$:/themes/tiddlywiki/vanilla/options/sidebarlayout}match[fluid-fixed]] %>
<$resizer
	class="tc-sidebar-resizer"
	direction="horizontal"
	tiddler="$:/themes/tiddlywiki/vanilla/metrics/sidebarwidth"
	min={{$:/themes/tiddlywiki/vanilla/metrics/sidebarminwidth}}
	max={{{ [[calc(100vw - ]addsuffix{$:/themes/tiddlywiki/vanilla/metrics/storyminwidth}addsuffix[)]] }}}
	default="350px"
	invert="yes"
	dblClickActions=<<fluid-fixed-dblclick-actions>>
	onResizeStart=<<on-resize-start-action-fluid-fixed>>
/>
<%elseif [{$:/themes/tiddlywiki/vanilla/options/sidebarlayout}match[fixed-fluid]] %>
<$resizer
	class="tc-sidebar-resizer"
	direction="horizontal"
	filter="$:/themes/tiddlywiki/vanilla/metrics/storyright $:/themes/tiddlywiki/vanilla/metrics/storywidth $:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth"
	min={{$:/themes/tiddlywiki/vanilla/metrics/storyminwidth}}
	max={{{ [[calc(100vw - ]addsuffix{$:/themes/tiddlywiki/vanilla/metrics/sidebarminwidth}addsuffix[ - ]addsuffix{$:/themes/tiddlywiki/vanilla/metrics/storyleft}addsuffix[)]] }}}
	default="770px"
	invert="no"
	dblClickActions=<<fixed-fluid-dblclick-actions>>
	onResizeStart=<<on-resize-start-action-fixed-fluid>>
/>
<% endif %>
<% endif %>

<$scrollable fallthrough="no" class="tc-sidebar-scrollable">

<div class="tc-sidebar-header">

<$reveal state="$:/state/sidebar" type="match" text="yes" default="yes" retain="yes" animate="yes">

<$list filter="[all[shadows+tiddlers]tag[$:/tags/SideBarSegment]!has[draft.of]]" variable="listItem">

<$reveal type="nomatch" state=<<config-title>> text="hide"  tag="div">

<$transclude tiddler=<<listItem>> mode="block"/>

</$reveal>

</$list>

</$reveal>

</div>

</$scrollable>

</div>
